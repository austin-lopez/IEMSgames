
<div class="login-page">
	<div class="form">
		<div class="formtitle"><br>Scorekeeping</div>
		<form class="login-form">
			<input id="nuid" type="text" placeholder="NetID"/>
			<input id="nick" type="text" placeholder="Nickname (optional)"/>
			<div id="sectionButtons"></div>
			<div class="message">
				Your nickname will be displayed in the public leaderboards. If left blank, your name associated with your NetID will display instead.
			</div>
		</form>
	</div>
</div>

<script>

	function waitForSheetsAndInitialize() {
		console.log("Attempting to load sheets...");
		if (typeof State !== "undefined" && State.variables.sheetsLoaded >= State.variables.sheetCount) {
			console.log("Sheets loaded. Initializing...");

			// Dynamically generate section buttons
			State.variables.sheetTitles.forEach((section, index) => {
				if (section !== "undefined") {
					const sectionButton = document.createElement('button');
					sectionButton.id = 'section' + index;
					sectionButton.textContent = section;
					sectionButton.classList.add('sections');
					document.getElementById('sectionButtons').appendChild(sectionButton);

					sectionButton.addEventListener('click', function(event) {
						event.preventDefault();
						document.querySelectorAll('.sections').forEach(button => button.classList.remove('clicked'));
						sectionButton.classList.add('clicked');
						currentSection = index;
					});
				}
			});

			// Function to handle form submission
			function submitLogin() {
				const netid = document.getElementById('nuid').value.toLowerCase();
				const fullname = document.getElementById('nick').value || netIdDatabase[netid.toUpperCase()] || 'Player "' + netid.substring(0, 3) + '"';

				if (/^[a-zA-Z]+[0-9]{3,4}$/.test(netid) && netid.length > 5 && netid.length < 8) {
					alert('Welcome, ' + fullname);
				} else {
					alert('Please input a valid NetID.');
				}
			}

		} else {
			console.log("Sheets are still loading... Retrying in 100ms");
			setTimeout(waitForSheetsAndInitialize, 100);
		}
	}

	// Start checking for sheet readiness
	waitForSheetsAndInitialize();
</script>